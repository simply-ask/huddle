{% extends 'dashboard/base.html' %}

{% block title %}Create Meeting - huddle{% endblock %}

{% block dashboard_content %}

<div style="max-width: 600px;">
    <!-- Simple header -->
    <div class="mb-40">
        <h1 style="font-size: 24px; font-weight: 500; margin-bottom: 8px;">Create Meeting</h1>
        <p class="text-muted">Set up a new meeting session</p>
    </div>

    <!-- Simple form -->
    <form method="post" class="card">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="title">Meeting Title</label>
            <input type="text" id="title" name="title" 
                   placeholder="Weekly standup" 
                   value="{{ title|default:'' }}" required>
        </div>
        
        <div class="form-group">
            <label for="attendees">Attendees</label>
            <textarea id="attendees" name="attendees" 
                      placeholder="john@company.com&#10;jane@company.com" 
                      rows="4">{{ attendees|default:'' }}</textarea>
            <div class="text-muted text-small" style="margin-top: 4px;">
                <i class="fas fa-info-circle"></i>
                Enter email addresses, one per line
            </div>
        </div>
        
        <div class="form-group">
            <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <input type="checkbox" name="send_invites" {% if not attendees %}checked{% endif %}>
                Send invitations now
            </label>
        </div>
        
        <div class="flex gap-10">
            <button type="submit" class="btn">
                <i class="fas fa-plus"></i>
                Create Meeting
            </button>
            <a href="{% url 'dashboard' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i>
                Back
            </a>
        </div>
    </form>
    
    <!-- Quick add from existing speakers -->
    {% if suggested_speakers %}
    <div class="card">
        <div class="flex-between mb-20">
            <h3 style="font-size: 18px; font-weight: 500;">Quick Add</h3>
            <div class="text-muted text-small">Existing speakers</div>
        </div>
        
        <div style="display: flex; flex-wrap: gap: 8px;">
            {% for speaker in suggested_speakers %}
            <button type="button" class="btn btn-small btn-secondary" 
                    onclick="addSpeaker('{{ speaker.email }}', '{{ speaker.full_name }}')"
                    style="font-size: 13px;">
                <i class="fas fa-plus"></i>
                {{ speaker.full_name }}
            </button>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Simple help -->
    <div class="card" style="background: #f8f9fa;">
        <div class="flex gap-20">
            <div>
                <div class="flex gap-10 mb-10">
                    <i class="fas fa-envelope" style="color: #666;"></i>
                    <span style="font-weight: 500;">Email Setup</span>
                </div>
                <div class="text-muted text-small">Attendees get voice setup links</div>
            </div>
            
            <div>
                <div class="flex gap-10 mb-10">
                    <i class="fas fa-microphone" style="color: #666;"></i>
                    <span style="font-weight: 500;">Voice Samples</span>
                </div>
                <div class="text-muted text-small">10-15 seconds for ID</div>
            </div>
            
            <div>
                <div class="flex gap-10 mb-10">
                    <i class="fas fa-phone" style="color: #666;"></i>
                    <span style="font-weight: 500;">Recording</span>
                </div>
                <div class="text-muted text-small">Single device captures all</div>
            </div>
        </div>
    </div>
</div>

<script>
function addSpeaker(email, name) {
    const attendeesField = document.getElementById('attendees');
    const currentValue = attendeesField.value.trim();
    
    // Check if email already exists
    if (currentValue.includes(email)) {
        return;
    }
    
    // Add the email
    const newValue = currentValue ? currentValue + '\n' + email : email;
    attendeesField.value = newValue;
    
    // Visual feedback
    const button = event.target.closest('button');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check"></i> Added';
    button.style.background = '#e8f5e8';
    button.style.color = '#2e7d32';
    
    setTimeout(() => {
        button.innerHTML = originalText;
        button.style.background = '';
        button.style.color = '';
    }, 1500);
}
</script>

{% endblock %}